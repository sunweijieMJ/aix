# AIX ç»„ä»¶åº“ç¤ºä¾‹é¡¹ç›®

è¿™æ˜¯ä¸€ä¸ªç”¨äºæ¼”ç¤ºå’Œæµ‹è¯• AIX Vue ç»„ä»¶åº“çš„ç¤ºä¾‹é¡¹ç›®ã€‚

**é‡è¦è¯´æ˜ï¼š** æœ¬é¡¹ç›®è™½ç„¶åœ¨ monorepo å†…ï¼Œä½†**æ¨¡æ‹Ÿå¤–éƒ¨ä¸šåŠ¡é¡¹ç›®çš„ä½¿ç”¨åœºæ™¯**ã€‚ç»„ä»¶åº“ä¾èµ–ä¸åœ¨ `package.json` ä¸­å£°æ˜ï¼Œè€Œæ˜¯é€šè¿‡ä»¥ä¸‹æ–¹å¼å¼•å…¥ï¼š
- **æºç æ¨¡å¼**ï¼šé€šè¿‡ Vite alias æ˜ å°„åˆ°ç»„ä»¶åº“æºç ï¼ˆé»˜è®¤ï¼Œæ”¯æŒçƒ­æ›´æ–°ï¼‰
- **Yalc æ¨¡å¼**ï¼šé€šè¿‡ `yalc add` æ·»åŠ æœ¬åœ°æ‰“åŒ…äº§ç‰©ï¼ˆæµ‹è¯•å‘å¸ƒå‰äº§ç‰©ï¼‰

è¿™ç§æ–¹å¼å®Œå…¨æ¨¡æ‹Ÿå¤–éƒ¨ä¸šåŠ¡ä»“åº“çš„è”è°ƒåœºæ™¯ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

```bash
# å®‰è£…ä¾èµ–ï¼ˆåœ¨é¡¹ç›®æ ¹ç›®å½•ï¼‰
pnpm install

# å¯åŠ¨ç¤ºä¾‹é¡¹ç›®
cd apps/example
pnpm dev
```

è®¿é—® http://localhost:5173 æŸ¥çœ‹ç»„ä»¶æ¼”ç¤º

---

## âš¡ å¿«é€Ÿå‘½ä»¤å‚è€ƒ

### ç¤ºä¾‹é¡¹ç›®å‘½ä»¤

| æ“ä½œ | å‘½ä»¤ | è¯´æ˜ |
|------|------|------|
| **å¯åŠ¨ï¼ˆæºç æ¨¡å¼ï¼‰** | `pnpm dev` | é»˜è®¤æ¨¡å¼ï¼Œæ”¯æŒçƒ­æ›´æ–° âœ¨ |
| **å¯åŠ¨ï¼ˆYalc æ¨¡å¼ï¼‰** | `pnpm dev:yalc` | æµ‹è¯•æ‰“åŒ…äº§ç‰© |
| **æ·»åŠ  Yalc** | `pnpm add:yalc` | æ·»åŠ  yalc é“¾æ¥ï¼ˆè‡ªåŠ¨ä¿å­˜å¤‡ä»½ï¼‰ |
| **ç§»é™¤ Yalc** | `pnpm remove:yalc` | ç§»é™¤ yalc é“¾æ¥ï¼Œæ¢å¤åŸé…ç½® |

### ç»„ä»¶åº“å‘½ä»¤ï¼ˆåœ¨æ ¹ç›®å½•æ‰§è¡Œï¼‰

| æ“ä½œ | å‘½ä»¤ | è¯´æ˜ |
|------|------|------|
| **ç¯å¢ƒæ£€æŸ¥** | `pnpm link:setup` | æ£€æŸ¥ Node/pnpm/yalc ç‰ˆæœ¬ |
| **å‘å¸ƒåˆ° Yalc** | `pnpm link:publish` | é¦–æ¬¡å‘å¸ƒæˆ–é‡æ–°å‘å¸ƒ |
| **æ¨é€æ›´æ–°** | `pnpm link:push` | æ›´æ–°å·²é“¾æ¥çš„é¡¹ç›® |

---

## ğŸ“¦ è”è°ƒæ¨¡å¼

æœ¬é¡¹ç›®æä¾›ä¸¤ç§è”è°ƒæ¨¡å¼ï¼Œå®Œå…¨æ¨¡æ‹Ÿå¤–éƒ¨ä¸šåŠ¡é¡¹ç›®çš„ä½¿ç”¨åœºæ™¯ã€‚

### ğŸ¤” åº”è¯¥ä½¿ç”¨å“ªç§æ¨¡å¼ï¼Ÿ

```
å¼€å‘é˜¶æ®µ
â”œâ”€ ä¿®æ”¹ç»„ä»¶æºç é¢‘ç¹ â†’ æºç æ¨¡å¼ âš¡
â”œâ”€ éœ€è¦çƒ­æ›´æ–° (HMR) â†’ æºç æ¨¡å¼ âš¡
â””â”€ æ—¥å¸¸å¼€å‘è°ƒè¯• â†’ æºç æ¨¡å¼ âš¡

å‘å¸ƒå‰æµ‹è¯•
â”œâ”€ éªŒè¯æ‰“åŒ…äº§ç‰© â†’ Yalc æ¨¡å¼ ğŸ“¦
â”œâ”€ æµ‹è¯•ç±»å‹å£°æ˜ â†’ Yalc æ¨¡å¼ ğŸ“¦
â””â”€ æ¨¡æ‹Ÿç”Ÿäº§ç¯å¢ƒ â†’ Yalc æ¨¡å¼ ğŸ“¦
```

---

### æ¨¡å¼ä¸€ï¼šæºç æ¨¡å¼ï¼ˆé»˜è®¤ï¼Œæ¨èæ—¥å¸¸å¼€å‘ï¼‰

**ç‰¹ç‚¹ï¼š**
- âœ… æ”¯æŒçƒ­æ›´æ–° (HMR)
- âœ… ä¿®æ”¹ç»„ä»¶åº“æºç ç«‹å³ç”Ÿæ•ˆ
- âœ… æ— éœ€æ„å»ºï¼Œå¯åŠ¨å¿«é€Ÿ
- âœ… é€‚åˆæ—¥å¸¸å¼€å‘è°ƒè¯•

**å¯åŠ¨æ–¹å¼ï¼š**
```bash
# é»˜è®¤å³ä¸ºæºç æ¨¡å¼
pnpm dev

# æˆ–æ˜¾å¼æŒ‡å®š
pnpm dev:source
```

**å·¥ä½œåŸç†ï¼š**
- Vite é€šè¿‡ alias å°† `@aix/button` ç­‰æ˜ å°„åˆ°ç»„ä»¶åº“æºç ç›®å½•
- æ— éœ€åœ¨ package.json å£°æ˜ä¾èµ–
- å®Œå…¨æ¨¡æ‹Ÿå¤–éƒ¨é¡¹ç›®é€šè¿‡ç›¸å¯¹è·¯å¾„å¼•ç”¨çš„åœºæ™¯

```typescript
// vite.config.ts
const AIX_ROOT = path.resolve(__dirname, '../../');
alias: {
  '@aix/button': path.resolve(AIX_ROOT, 'packages/button/src'),
  '@aix/theme': path.resolve(AIX_ROOT, 'packages/theme/src'),
  '@aix/hooks': path.resolve(AIX_ROOT, 'packages/hooks/src'),
}
```

**éªŒè¯çƒ­æ›´æ–°ï¼š**
1. ä¿æŒå¼€å‘æœåŠ¡å™¨è¿è¡Œ
2. ä¿®æ”¹ `../../packages/button/src/Button.vue`
3. è§‚å¯Ÿæµè§ˆå™¨è‡ªåŠ¨åˆ·æ–° âœ¨

---

### æ¨¡å¼äºŒï¼šYalc æ¨¡å¼ï¼ˆæµ‹è¯•æ‰“åŒ…äº§ç‰©ï¼‰

**ç‰¹ç‚¹ï¼š**
- âœ… æµ‹è¯•çœŸå®çš„æ‰“åŒ…äº§ç‰©
- âœ… æ¨¡æ‹Ÿ npm å‘å¸ƒåçš„ä½¿ç”¨åœºæ™¯
- âœ… éªŒè¯ç±»å‹å£°æ˜ã€å¯¼å‡ºç­‰
- âš ï¸ ä¿®æ”¹åéœ€é‡æ–°æ„å»ºå’Œæ¨é€

**å¿«é€Ÿä½¿ç”¨ï¼š**

```bash
# 1. å‘å¸ƒåˆ° Yalcï¼ˆåœ¨ç»„ä»¶åº“æ ¹ç›®å½•ï¼‰
cd ../.. && pnpm link:publish

# 2. æ·»åŠ ä¾èµ–ï¼ˆåœ¨ç¤ºä¾‹é¡¹ç›®ï¼‰
cd apps/example
pnpm add:yalc  # äº¤äº’å¼é€‰æ‹©è¦æ·»åŠ çš„åŒ…ï¼Œè‡ªåŠ¨ä¿å­˜å¤‡ä»½

# 3. å¯åŠ¨ Yalc æ¨¡å¼
pnpm dev:yalc

# 4. æ¸…ç†ï¼ˆåˆ‡æ¢å›æºç æ¨¡å¼ï¼‰
pnpm remove:yalc && pnpm dev
```

> ğŸ’¡ **è¯¦ç»†æ­¥éª¤å’Œå·¥ä½œæµç¨‹ï¼š** è¯·å‚è€ƒ [Yalc å·¥å…·æ–‡æ¡£](../../scripts/link/README.md#å®Œæ•´å·¥ä½œæµç¨‹å¤–éƒ¨ä¸šåŠ¡é¡¹ç›®)

**è¯´æ˜ï¼š** `add:yalc` è„šæœ¬ä¼šè‡ªåŠ¨ä¿å­˜å½“å‰ä¾èµ–ç‰ˆæœ¬åˆ° `.yalc.backup.json`ï¼Œ`remove:yalc` è„šæœ¬ä¼šè‡ªåŠ¨æ¢å¤è¿™äº›ç‰ˆæœ¬ã€‚è¯¦ç»†è¯´æ˜è¯·å‚è€ƒ [scripts/README.md](./scripts/README.md)ã€‚

---

## ğŸ’¡ å¤–éƒ¨ä¸šåŠ¡é¡¹ç›®ä½¿ç”¨æŒ‡å—

å¦‚æœä½ çš„ä¸šåŠ¡é¡¹ç›®åœ¨**å¤–éƒ¨ä»“åº“**ï¼ˆä¸åœ¨æ­¤ monorepo å†…ï¼‰ï¼Œå®Œå…¨å¯ä»¥å‚è€ƒæœ¬ç¤ºä¾‹é¡¹ç›®çš„é…ç½®ï¼š

### æ–¹å¼ä¸€ï¼šæºç æ¨¡å¼ï¼ˆæ¨èå¼€å‘é˜¶æ®µï¼‰

**1. å¤åˆ¶ vite.config.ts é…ç½®**
```typescript
// ä¿®æ”¹ AIX_ROOT ä¸ºç»„ä»¶åº“çš„å®é™…è·¯å¾„
const AIX_ROOT = '/path/to/aix'; // ä¾‹å¦‚ï¼š'/Users/you/workspace/aix'

const getAlias = (): AliasOptions => {
  if (process.env.VITE_LINK_MODE === 'source') {
    return {
      '@aix/button': path.resolve(AIX_ROOT, 'packages/button/src'),
      '@aix/theme': path.resolve(AIX_ROOT, 'packages/theme/src'),
      '@aix/hooks': path.resolve(AIX_ROOT, 'packages/hooks/src'),
    };
  }
  return {};
};
```

**2. å¯åŠ¨é¡¹ç›®**
```bash
VITE_LINK_MODE=source pnpm dev
```

### æ–¹å¼äºŒï¼šYalc æ¨¡å¼ï¼ˆæ¨èæµ‹è¯•é˜¶æ®µï¼‰

æŒ‰ç…§ä¸Šé¢"æ¨¡å¼äºŒï¼šYalc æ¨¡å¼"çš„æ­¥éª¤æ“ä½œå³å¯ã€‚

è¯¦ç»†è¯´æ˜è¯·å‚è€ƒ [è”è°ƒå·¥å…·æ–‡æ¡£](../../scripts/link/README.md)ã€‚

---

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
apps/example/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ App.vue          # ç¤ºä¾‹åº”ç”¨ä¸»ç»„ä»¶
â”‚   â””â”€â”€ main.ts          # åº”ç”¨å…¥å£ï¼ˆä¸»é¢˜åˆå§‹åŒ–ï¼‰
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ add-yalc.ts      # æ·»åŠ  yalc é“¾æ¥è„šæœ¬ï¼ˆè‡ªåŠ¨ä¿å­˜å¤‡ä»½ï¼‰
â”‚   â”œâ”€â”€ remove-yalc.ts   # ç§»é™¤ yalc é“¾æ¥è„šæœ¬ï¼ˆè‡ªåŠ¨æ¢å¤é…ç½®ï¼‰
â”‚   â””â”€â”€ README.md        # è„šæœ¬ä½¿ç”¨æ–‡æ¡£
â”œâ”€â”€ index.html           # HTML æ¨¡æ¿
â”œâ”€â”€ vite.config.ts       # Vite é…ç½®ï¼ˆè”è°ƒæ ¸å¿ƒï¼‰
â”œâ”€â”€ tsconfig.json        # TypeScript é…ç½®
â”œâ”€â”€ package.json         # é¡¹ç›®é…ç½®
â””â”€â”€ README.md            # æœ¬æ–‡æ¡£
```

---

## ğŸ¨ ç¤ºä¾‹åŠŸèƒ½

å½“å‰æ¼”ç¤ºé¡µé¢åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š

### Button ç»„ä»¶æ¼”ç¤º
- âœ… åŸºç¡€æŒ‰é’®ï¼ˆ5ç§ç±»å‹ï¼‰
- âœ… ç¦ç”¨çŠ¶æ€
- âœ… åŠ è½½çŠ¶æ€
- âœ… ä¸åŒå°ºå¯¸ï¼ˆsmall/medium/largeï¼‰

### ä¸»é¢˜ç³»ç»Ÿ
- âœ… äº®è‰²/æš—è‰²ä¸»é¢˜åˆ‡æ¢
- âœ… å“åº”å¼ CSS å˜é‡
- âœ… localStorage æŒä¹…åŒ–
- âœ… è·Ÿéšç³»ç»Ÿä¸»é¢˜

### è”è°ƒæ¨¡å¼æ˜¾ç¤º
- âœ… å®æ—¶æ˜¾ç¤ºå½“å‰è”è°ƒæ¨¡å¼
- âœ… ä½¿ç”¨è¯´æ˜å¡ç‰‡

---

---

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: ç«¯å£è¢«å ç”¨

**ç°è±¡ï¼š**
```
Port 5173 is in use, trying another one...
```

**è¯´æ˜ï¼š** æ­£å¸¸ç°è±¡ï¼ŒVite ä¼šè‡ªåŠ¨å°è¯•ä¸‹ä¸€ä¸ªå¯ç”¨ç«¯å£ï¼ˆ5174, 5175...ï¼‰

---

### é—®é¢˜ 2: ä¿®æ”¹ç»„ä»¶åº“ä»£ç åé¡µé¢æ²¡æœ‰æ›´æ–°

**è§£å†³æ–¹æ¡ˆï¼š**

1. **ç¡®è®¤ä½¿ç”¨æºç æ¨¡å¼**
   ```bash
   # æ£€æŸ¥æ§åˆ¶å°è¾“å‡º
   # åº”æ˜¾ç¤ºï¼šğŸ”— è”è°ƒæ¨¡å¼: æºç æ˜ å°„ (æ”¯æŒçƒ­æ›´æ–°)
   ```

2. **æ¸…é™¤ Vite ç¼“å­˜**
   ```bash
   rm -rf node_modules/.vite
   pnpm dev
   ```

3. **æ£€æŸ¥ alias é…ç½®**
   ```bash
   # æŸ¥çœ‹ vite.config.ts ä¸­çš„ AIX_ROOT è·¯å¾„æ˜¯å¦æ­£ç¡®
   ```

---

### é—®é¢˜ 3: Yalc æ¨¡å¼ä¸‹æŠ¥é”™æ‰¾ä¸åˆ°æ¨¡å—

**è§£å†³æ–¹æ¡ˆï¼š**

1. **ç¡®ä¿å·²å‘å¸ƒåˆ° Yalc**
   ```bash
   cd ../..
   pnpm link:publish
   ```

2. **ç¡®ä¿å·²æ·»åŠ ä¾èµ–**
   ```bash
   yalc add @aix/button @aix/theme @aix/hooks
   pnpm install
   ```

3. **æ£€æŸ¥ package.json**
   ```json
   {
     "dependencies": {
       "@aix/button": "file:.yalc/@aix+button",
       "@aix/theme": "file:.yalc/@aix+theme"
     }
   }
   ```

---

### é—®é¢˜ 4: TypeScript æŠ¥é”™

**è§£å†³æ–¹æ¡ˆï¼š**

1. **é‡å¯ TypeScript æœåŠ¡**
   - VSCode: `Cmd/Ctrl + Shift + P` â†’ `Restart TS Server`

2. **æ£€æŸ¥ tsconfig.json**
   ```json
   {
     "extends": "@kit/typescript-config/base-app.json",
     "include": ["src/**/*", "src/**/*.vue"]
   }
   ```

3. **ç¡®ä¿ä¾èµ–å·²å®‰è£…**
   ```bash
   pnpm install
   ```

---

### é—®é¢˜ 5: æ ·å¼æ²¡æœ‰ç”Ÿæ•ˆ

**è§£å†³æ–¹æ¡ˆï¼š**

1. **æ£€æŸ¥ä¸»é¢˜åˆå§‹åŒ–**
   ```typescript
   // src/main.ts åº”è¯¥æœ‰ï¼š
   import { createTheme } from '@aix/theme';
   const theme = createTheme();
   app.use(theme.install);
   ```

2. **æ£€æŸ¥ CSS å˜é‡**
   - æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·
   - æ£€æŸ¥ `<html>` å…ƒç´ çš„ CSS å˜é‡ï¼ˆ--colorPrimary ç­‰ï¼‰

3. **æ¸…é™¤ç¼“å­˜**
   ```bash
   rm -rf node_modules/.vite
   pnpm dev
   ```

---

## ğŸ’¡ å¼€å‘æŠ€å·§

### 1. Yalc è„šæœ¬ä½¿ç”¨

**æ·»åŠ  yalc é“¾æ¥ï¼š**

```bash
pnpm add:yalc  # äº¤äº’å¼é€‰æ‹©è¦æ·»åŠ çš„åŒ…
```

**ç‰¹æ€§ï¼š**
- è‡ªåŠ¨ä¿å­˜å½“å‰ä¾èµ–ç‰ˆæœ¬åˆ° `.yalc.backup.json`
- äº¤äº’å¼é€‰æ‹©è¦æ·»åŠ çš„ç»„ä»¶åŒ…
- è‡ªåŠ¨æ‰§è¡Œ yalc add å’Œ pnpm install

**ç§»é™¤ yalc é“¾æ¥ï¼š**

```bash
pnpm remove:yalc  # è‡ªåŠ¨æ¢å¤åŸå§‹ç‰ˆæœ¬
```

**ç‰¹æ€§ï¼š**
- è‡ªåŠ¨æ£€æµ‹ `.yalc.backup.json` å¤‡ä»½
- æ¢å¤åŸå§‹ npm åŒ…ç‰ˆæœ¬ï¼ˆå¦‚æœæœ‰ï¼‰
- è‡ªåŠ¨æ¸…ç† yalc ç›¸å…³æ–‡ä»¶

**è¯¦ç»†è¯´æ˜ï¼š** æŸ¥çœ‹ [scripts/README.md](./scripts/README.md)

### 2. å¿«é€Ÿåˆ‡æ¢æ¨¡å¼

åˆ›å»º `.env.local` æ–‡ä»¶ï¼ˆå·²åœ¨ .gitignore ä¸­ï¼‰ï¼š
```bash
# .env.local
VITE_LINK_MODE=source  # æˆ– yalc
```

### 3. è°ƒè¯•ç»„ä»¶æ ·å¼

ä½¿ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼š
1. å³é”®ç»„ä»¶ â†’ æ£€æŸ¥å…ƒç´ 
2. æŸ¥çœ‹åº”ç”¨çš„ CSS å˜é‡
3. å®æ—¶ä¿®æ”¹æ ·å¼æµ‹è¯•æ•ˆæœ

### 4. æ·»åŠ æ–°ç»„ä»¶ç¤ºä¾‹

ç¼–è¾‘ `src/App.vue`ï¼š
```vue
<script setup lang="ts">
import { Button, NewComponent } from '@aix/button';
</script>

<template>
  <NewComponent />
</template>
```

### 5. æ€§èƒ½åˆ†æ

```bash
# æ„å»ºåˆ†æ
pnpm build
pnpm storybook:dev

# æŸ¥çœ‹æ„å»ºäº§ç‰©å¤§å°
ls -lh dist/assets/
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [ç»„ä»¶åº“ä¸» README](../../README.md)
- [è”è°ƒå·¥å…·æ–‡æ¡£](../../scripts/link/README.md)
- [å…¨é¢è¯„ä¼°æŠ¥å‘Š](../../REVIEW_LINKING_SOLUTION.md)

---

## ğŸ¯ ä¸‹ä¸€æ­¥

### å¼€å‘æ–°ç»„ä»¶
1. åœ¨ `packages/` åˆ›å»ºæ–°ç»„ä»¶
2. åœ¨æœ¬ç¤ºä¾‹é¡¹ç›®ä¸­å¼•å…¥æµ‹è¯•
3. éªŒè¯çƒ­æ›´æ–°å’Œæ ·å¼

### æµ‹è¯•æ‰“åŒ…
1. åˆ‡æ¢åˆ° Yalc æ¨¡å¼
2. éªŒè¯æ‰“åŒ…äº§ç‰©åŠŸèƒ½
3. æ£€æŸ¥ç±»å‹å£°æ˜æ–‡ä»¶

### åœ¨ä¸šåŠ¡é¡¹ç›®ä¸­ä½¿ç”¨
1. å¤åˆ¶ `vite.config.ts` é…ç½®
2. æ ¹æ®å®é™…æƒ…å†µä¿®æ”¹ AIX_ROOT è·¯å¾„
3. äº«å—ä¾¿æ·çš„è”è°ƒä½“éªŒ

---

## ğŸ¤ è´¡çŒ®

å¦‚éœ€æ”¹è¿›ç¤ºä¾‹é¡¹ç›®ï¼š
1. æ·»åŠ æ›´å¤šç»„ä»¶æ¼”ç¤º
2. ä¼˜åŒ–é¡µé¢è®¾è®¡
3. æ·»åŠ äº¤äº’åŠŸèƒ½
4. æäº¤ PR

---

**æ„‰å¿«åœ°å¼€å‘å’Œæµ‹è¯•ç»„ä»¶åº“ï¼** ğŸ‰
